<ion-content class="crea-content">

  <!--RIEPILOGO DINAMICO (appare dopo la conferma della città)-->
  <div class="riepilogo-header animated" [class.show]="city" *ngIf="city">
    <div class="circle-icon">
      <ion-icon name="airplane"></ion-icon>
    </div>
    <div class="trip-info">
      <span class="trip-city">{{ city }}</span>
      <div class="trip-details">
        <span *ngIf="accommodation">
          <span class="trip-detail-label">Alloggio:</span>
          <span class="trip-detail-val">{{ accommodation }}</span>
        </span>
        <span *ngIf="dates.start">
          <span class="trip-detail-label">Date:</span>
          <span class="trip-detail-val">
            {{ dates.start | date:'dd/MM/yyyy' }}
            <ng-container *ngIf="dates.end">- {{ dates.end | date:'dd/MM/yyyy' }}</ng-container>
          </span>
        </span>
      </div>
    </div>
  </div>

  <!-- WRAPPER PER GLI STEP (scroll orizzontale) -->
  <div class="steps-wrapper" [style.transform]="'translateX(-' + (step - 1) * 100 + 'vw)'">

    <!-- STEP 1: CITTÀ -->
    <div class="step-card">
      <h2>In quale città sei?</h2>

      <app-google-autocomplete placeholder="Città" [types]="['(cities)']" [restrictToBounds]="false"
        [(value)]="cityInput" (placeSelected)="handleCityPlace($event)" (valueChange)="isCityValid = false">
      </app-google-autocomplete>


      <button class="next-btn" [disabled]="!isCityValid" (click)="step = 2">Avanti</button>
    </div>

    <!-- STEP 2: ALLOGGIO -->
    <div class="step-card">
      <h2>Dove alloggi?</h2>
      <!-- CORRETTO -->
      <app-google-autocomplete placeholder="Nome o indirizzo alloggio" [types]="['lodging']" [bounds]="cityBounds"
        [restrictToBounds]="true" [(value)]="accommodationInput" (placeSelected)="handleAccommodationPlace($event)"
        (valueChange)="isAccommodationValid = false">
      </app-google-autocomplete>


      <button class="prev-btn" (click)="prevStep()">Indietro</button>
      <button class="next-btn" [disabled]="!isAccommodationValid"
        (click)="setAccommodation(accommodationInput)">Avanti</button>
    </div>

    <!-- STEP 3: DATE -->
    <div class="step-card">
      <h2>Quando?</h2>
      <app-range-calendar-lite [minDate]="today" (datesSelected)="onDatesSelected($event)">
      </app-range-calendar-lite>
      <button class="prev-btn" (click)="prevStep()">Indietro</button>
      <button class="next-btn" [disabled]="!datesInput.start || !datesInput.end"
        (click)="setDates(datesInput.start, datesInput.end)">
        Avanti
      </button>
    </div>

    <!-- STEP 4: RIEPILOGO E CONFERMA -->
    <div class="step-card">
      <h2>Riepilogo viaggio</h2>
      <ul>
        <li><b>Città:</b> {{ city }}</li>
        <li><b>Alloggio:</b> {{ accommodation }}</li>
        <li><b>Date:</b> {{ dates.start | date:'dd/MM/yyyy' }} - {{ dates.end | date:'dd/MM/yyyy' }}</li>
      </ul>
      <button class="prev-btn" (click)="prevStep()">Indietro</button>
      <button class="next-btn conferma" (click)="confirm()">Conferma</button>
    </div>

  </div>

</ion-content>