<ion-page>
  <!-- HEADER -->
  <app-header
    [title]="'SoTourist'"
    [iconName]="'settings-outline'"
    [showBackButton]="false">
  </app-header>

  <!-- CONTENUTO -->
  <ion-content class="ion-padding settings-content" fullscreen>

    <ion-card class="profile-card">
      <ion-item lines="none">
      <!-- -->
        <app-profile-icon class="profile-icon"
          [src]="profileImageUrl"
          [editable]="true"
          (changed)="profileImageUrl = $event">
        </app-profile-icon> <!---->
       
        <ion-label>
          <h2>{{ username || 'Nuovo utente' }}</h2>
          <p>{{ email || 'email@example.com' }}</p>
          <ion-badge color="warning">Explorer âœ¨</ion-badge>
        </ion-label>

        <ion-button slot="end" fill="clear" (click)="editing = !editing">
          <ion-icon name="create-outline"></ion-icon>
        </ion-button>
      </ion-item>

      <div *ngIf="editing" class="edit-fields">
        <ion-input label="Username" [(ngModel)]="username" maxlength="20"></ion-input>
        <ion-input label="Email"    [(ngModel)]="email" type="email" maxlength="20"></ion-input>
        <ion-input label="Password" [(ngModel)]="password" type="password" autocomplete="new-password"></ion-input>
        <ion-button expand="block" color="success" (click)="saveProfile()">Salva</ion-button>
      </div>
    </ion-card>

    <ion-list lines="inset" inset="true">

      <ion-list-header>Preferenze</ion-list-header>

      <ion-item>
        <ion-label>Notifiche</ion-label>
        <ion-toggle slot="end"
                    [(ngModel)]="notificationsEnabled"
                    (ionChange)="toggleNotifications()"></ion-toggle>
      </ion-item>

      <ion-item>
        <ion-label>Tema scuro</ion-label>
        <ion-toggle slot="end"
                    [(ngModel)]="darkMode"
                    (ionChange)="toggleDarkMode()"></ion-toggle>
      </ion-item>

      <ion-item>
        <ion-label>Lingua</ion-label>
        <ion-select slot="end" interface="popover"
                    [(ngModel)]="language"
                    (ionChange)="changeLanguage()">
          <ion-select-option value="it">Italiano</ion-select-option>
          <ion-select-option value="en">English</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item>
        <ion-label>Sync automatica</ion-label>
        <ion-toggle slot="end"
                    [(ngModel)]="autoSync"
                    (ionChange)="toggleAutoSync()"></ion-toggle>
      </ion-item>

      <ion-item *ngIf="lastSync">
        <ion-icon name="refresh-outline" slot="start"></ion-icon>
        <ion-label>Ultima sync: {{ lastSync | date:'short' }}</ion-label>
        <ion-button slot="end" size="small" (click)="manualSync()">Sync ora</ion-button>
      </ion-item>
    </ion-list>

    <ion-list lines="inset" inset="true">
      <ion-list-header>Sicurezza</ion-list-header>

      <ion-item button detail (click)="changePassword()">
        <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
        <ion-label>Cambia password</ion-label>
      </ion-item>

      <ion-item button detail color="danger" (click)="confirmDeleteAccount()">
        <ion-icon name="trash-outline" slot="start"></ion-icon>
        <ion-label>Elimina account</ion-label>
      </ion-item>
    </ion-list>

    <ion-list lines="inset" inset="true">
      <ion-list-header>App</ion-list-header>

      <ion-item button detail (click)="openAbout()">
        <ion-icon name="information-circle-outline" slot="start"></ion-icon>
        <ion-label>Info &amp; versione</ion-label>
      </ion-item>

      <ion-item button detail (click)="openPrivacy()">
        <ion-icon name="shield-checkmark-outline" slot="start"></ion-icon>
        <ion-label>Privacy e licenze</ion-label>
      </ion-item>

      <ion-item color="medium" button detail (click)="confirmLogout()">
        <ion-icon name="log-out-outline" slot="start"></ion-icon>
        <ion-label>Logout</ion-label>
      </ion-item>
    </ion-list>

  </ion-content>
</ion-page>
