
# ğŸ“˜ API REST â€“ SoTourist Backend

Queste API gestiscono utenti e itinerari allâ€™interno del progetto **SoTourist**, con un database locale (`db.json`) simulato tramite file JSON. Tutti gli endpoint sono accessibili sotto forma di chiamate HTTP e gestiti da Express.

---

## ğŸ” Autenticazione â€“ `/api/auth`

### â–¶ï¸ POST `/api/auth/register`
**Registra un nuovo utente.**

**Request body:**
```json
{
  "username": "gabry",
  "email": "gabry@example.com",
  "passwordHash": "HASH_GENERATO_DAL_CLIENT",
  "type": "standard"
}
```

**Risposte:**
- `201 Created` â†’ utente registrato
- `400 Bad Request` â†’ email giÃ  esistente

---

### â–¶ï¸ POST `/api/auth/login`
**Esegue il login verificando lâ€™hash.**

**Request body:**
```json
{
  "email": "gabry@example.com",
  "passwordHash": "HASH_GENERATO_DAL_CLIENT"
}
```

**Risposte:**
- `200 OK` â†’ login riuscito, restituisce ID utente e tipo
- `401 Unauthorized` â†’ credenziali errate

---

## ğŸ‘¤ Itinerari utente â€“ `/api/users/:userId/itineraries`

### â–¶ï¸ GET `/api/users/:userId/itineraries?filter=...`
**Restituisce gli itinerari di un utente con possibilitÃ  di filtrare per stato.**

**Filtri disponibili (facoltativi):**

| `filter`    | Descrizione                                       |
|-------------|---------------------------------------------------|
| `all`       | Tutti gli itinerari (default)                     |
| `current`   | Quelli attualmente in corso                       |
| `upcoming`  | Il prossimo che deve ancora iniziare              |
| `future`    | Tutti quelli futuri (non ancora iniziati)         |
| `past`      | Itinerari giÃ  conclusi                            |

**Esempio:**
```
GET /api/users/user_123/itineraries?filter=past
```

---

### â–¶ï¸ POST `/api/users/:userId/itineraries`
**Crea un nuovo itinerario per un utente.**

**Request body:**
```json
{
  "city": "Roma",
  "accommodation": "Hotel Centro",
  "startDate": "2025-07-01",
  "endDate": "2025-07-05",
  "style": "culturale",
  "coverPhoto": "https://...",
  "places": [ ... ]
}
```

**Risposte:**
- `201 Created` â†’ itinerario aggiunto
- `404 Not Found` â†’ utente non trovato

---

### â–¶ï¸ DELETE `/api/users/:userId/itineraries/:itineraryId`
**Elimina un itinerario specifico.**

**Risposte:**
- `204 No Content` â†’ eliminazione riuscita
- `404 Not Found` â†’ utente o itinerario non trovato

---

## ğŸŒ Esplora itinerari pubblici â€“ `/api/itineraries`

### â–¶ï¸ GET `/api/itineraries?city=...`
**Restituisce tutti gli itinerari creati da qualsiasi utente per una specifica cittÃ .**

**Esempio:**
```
GET /api/itineraries?city=Napoli
```

**Risposta:**
```json
[
  {
    "itineraryId": "trip_123",
    "city": "Napoli",
    "startDate": "2025-06-01",
    "endDate": "2025-06-05",
    "places": [ ... ]
  },
  ...
]
```

---

## ğŸ“¦ JSON Structure

- Gli utenti sono salvati in `db.json` come array
- Ogni utente ha un array `itineraries`
- Ogni itinerario ha un campo `places` con tappe giornaliere

---

## ğŸ›¡ Sicurezza

- Le password **devono essere hashate dal frontend**
- Le richieste devono essere fatte su connessione **HTTPS** (in produzione)
